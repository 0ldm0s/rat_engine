# HAProxy 配置 - gRPC 代理测试（方案 D：HTTP/1.1 透传）
# 客户端 → HAProxy:8443 → gRPC:50051

global
    log stdout local0

defaults
    log global
    mode http
    timeout connect 5s
    timeout client  30s
    timeout server 30s
    option httplog
    option dontlognull

# 统计页面
listen stats
    bind *:8404
    mode http
    stats enable
    stats uri /
    stats refresh 10s

# HTTPS 前端
frontend grpc_front
    mode http
    bind *:8443 ssl crt /home/oldmos/workspaces/rust/rat_engine/examples/certs/ligproxy-test.0ldm0s.net-combined.pem alpn h2,http/1.1
    default_backend grpc_backend

# gRPC 后端
backend grpc_backend
    mode http
    server grpc1 127.0.0.1:50051
